package basisFx.appCore;

import basisFx.appCore.elements.AppNode;
import basisFx.appCore.elements.TableWrapper;
import basisFx.domain.ActiveRecord;
import basisFx.service.AplicationService;
import basisFx.service.ServiceSingleEditableSubmitTable;

public class MediatorSingleTable extends Mediator {

    private TableWrapper tableWrapper;

    public void setTableWrapper(TableWrapper tableWrapper) {
        this.tableWrapper = tableWrapper;
    }

    @Override
    public void inform(AppNode node) {

    }

    @Override
    public void wasRemoved(AppNode node, ActiveRecord record) {
        boolean readyToTransaction = record.isReadyToTransaction();
        if (readyToTransaction) {
            ServiceSingleEditableSubmitTable.wasRemoved(node, record, ((TableWrapper) node).unitOfWork);
        }
    }

    @Override
    public void wasChanged(AppNode node, ActiveRecord record) {
        boolean readyToTransaction = record.isReadyToTransaction();
        if (readyToTransaction) {
            ServiceSingleEditableSubmitTable.wasChanged(node, record, ((TableWrapper) node).unitOfWork);
        }
    }

    @Override
    public void refresh(AppNode node) {
        TableWrapper tableWrapper = (TableWrapper) node;
        AplicationService.refreshTable(tableWrapper,tableWrapper.activeRecord.getAll());
    }

    @Override
    public void initElements() {
        tableWrapper.setItems(tableWrapper.activeRecord.getAll());
    }

}
